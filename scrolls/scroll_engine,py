# scrolls/scroll_engine.py

from scrolls.api_scrolls import available_scrolls
from scrolls.trigger_manager import trigger_scroll
from codex.ingestion import query_codex
from emotion.emotion_engine import update_emotional_state

class ScrollEngine:
    def __init__(self):
        self.invoked_scrolls = []

    def cast_scroll(self, scroll_name: str, context: dict = {}):
        if scroll_name not in available_scrolls:
            print(f"[ScrollEngine] Unknown scroll: {scroll_name}")
            return

        print(f"[ScrollEngine] Casting scroll: {scroll_name}")
        result = available_scrolls[scroll_name](context)
        self.invoked_scrolls.append((scroll_name, result))

        # Update emotional state post-invocation
        update_emotional_state(scroll_name)

        return result

    def list_cast_history(self):
        return self.invoked_scrolls
